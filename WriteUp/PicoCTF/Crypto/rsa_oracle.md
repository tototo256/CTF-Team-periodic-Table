## PicoCTF2024 rsa_oracle
# 概要
暗号化された暗号文(secret.enc)とパスワード(password.enc)が与えられ、暗号文の内容を見るとOpenSSL のパスワードベース暗号化フォーマット（Salted__ ヘッダ + 8 バイトソルト）で暗号化されていることがわかる。

パスワードはRSAで暗号化されており、オラクルがncで提供される。

任意の平文の暗号化、複合化が可能なので[適応的選択平文攻撃](https://discord.com/channels/1420301824547618888/1421063481175703552/1421074329956778064)が可能。

# 手順
1. オラクルに数値の2(ASCII制御文字のSTX)を暗号化させる
2. 1の結果にCをかけて複合する
3. 2の結果を2で割り、long_to_bytesで文字列に直す
```python
from Crypto.Util.number import long_to_bytes

C2=5067313465613043651275429665315895824157755779222372979446076012356324498190828210335763979330272318657269048435311897896433721115606764442199497891219230 # 2を暗号化した結果
C=4228273471152570993857755209040611143227336245190875847649142807501848960847851973658239485570030833999780269457000091948785164374915942471027917017922546

print(C2*C)

rM = 0xc8c2607272　# 複合した結果

print(long_to_bytes(rM//2))
```

この手順でOpenSSLのパスワードがわかるのでopensslコマンドで複合する
```bash
openssl enc -d -aes-256-cbc -in secret.enc -out secret.txt
```